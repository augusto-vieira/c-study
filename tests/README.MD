# ğŸ“˜ Projeto de Testes UnitÃ¡rios e Cobertura de CÃ³digo em C

Projeto organizado com `Makefile`, testes unitÃ¡rios usando **`CMocka`** e **`CUnit`** e cobertura de cÃ³digo com **`lcov` e `gcovr`.**

## âš™ï¸ Ferramentas Explicadas
#### ğŸ§ª `libcunit1-dev`
- **O que Ã©:** Biblioteca **CUnit** para testes em C.
- **Para que serve:** Criar **testes unitÃ¡rios simples** para funÃ§Ãµes em C.
- **AplicaÃ§Ã£o:** Verificar se funÃ§Ãµes retornam os valores esperados.
- **Exemplo:** Testar se `soma(2, 2)` retorna `4`.

ğŸ†š **Mais antigo e bÃ¡sico**, ideal para projetos simples.

---
#### ğŸ§ª `libcmocka-dev`
- **O que Ã©:** Biblioteca **CMocka**, tambÃ©m para C.
- **Para que serve:** Criar **testes unitÃ¡rios mais avanÃ§ados**, com suporte a **mocks** e melhores asserts.
- **AplicaÃ§Ã£o:** Testar funÃ§Ãµes complexas, isolando dependÃªncias (como arquivos, rede, banco de dados).
- **Exemplo:** Testar uma funÃ§Ã£o que acessa o banco simulando a resposta do banco (mock).

ğŸš€ **Mais moderno e poderoso** que CUnit.

---
#### ğŸ“Š `lcov`
- **O que Ã©:** Ferramenta de **anÃ¡lise de cobertura de testes** para C/C++.
- **Para que serve:** Mostrar **quais partes do cÃ³digo foram executadas** durante os testes.
- **AplicaÃ§Ã£o:** Gerar relatÃ³rios de cobertura em HTML.
- **Exemplo:** Ver se todas as linhas da funÃ§Ã£o `calculaDesconto()` foram testadas.

âœ… Usa dados gerados pelo `gcov`.

---
#### ğŸ“Š `gcovr`
- **O que Ã©:** Ferramenta **mais simples e automatizada** para gerar relatÃ³rios de cobertura a partir do `gcov`.
- **Para que serve:** Criar relatÃ³rios de cobertura de forma rÃ¡pida, em texto, XML ou HTML.
- **AplicaÃ§Ã£o:** Integrar cobertura de cÃ³digo em pipelines CI/CD.
- **Exemplo:** Gerar um relatÃ³rio `.xml` para o Jenkins ou GitLab CI mostrar a cobertura dos testes.

âš™ï¸ **Mais leve** e fÃ¡cil de automatizar que `lcov`.

---
### ğŸ” Resumo Comparativo

| Ferramenta       | Linguagem | FunÃ§Ã£o                                | Tipo de SaÃ­da            |
|------------------|-----------|----------------------------------------|---------------------------|
| `libcunit1-dev`  | C         | Testes unitÃ¡rios simples               | SaÃ­da de testes (texto)   |
| `libcmocka-dev`  | C         | Testes unitÃ¡rios avanÃ§ados com mocks  | SaÃ­da de testes (texto)   |
| `lcov`           | C/C++     | AnÃ¡lise de cobertura (baseado em gcov)| HTML                      |
| `gcovr`          | C/C++     | AnÃ¡lise de cobertura automatizada     | Texto, HTML, XML, JSON    |

---
## ğŸ” Sobre os Arquivos de Cobertura

| ExtensÃ£o | Gerado por | Finalidade                            |
|----------|------------|----------------------------------------|
| `.gcno`  | gcc        | Guarda o **mapa de instrumentaÃ§Ã£o** do cÃ³digo           |
| `.gcda`  | executÃ¡vel | Armazena **dados de cobertura** em tempo de execuÃ§Ã£o                      |
| `.gcov`  | gcov       | Gera um **relatÃ³rio legÃ­vel** da cobertura por linha          |

---
## ğŸ”§ Instalando as DependÃªncias

Instale os pacotes necessÃ¡rios com:

```bash
sudo apt install build-essential libcmocka-dev lcov gcovr xdg-utils
```
---
## ğŸ“ Estrutura de DiretÃ³rios

```bash
.
â”œâ”€â”€ Makefile                   â† Comandos de build, teste e cobertura
â”œâ”€â”€ README.md                  â† DocumentaÃ§Ã£o do projeto
â”œâ”€â”€ cobertura_html/            â† RelatÃ³rios HTML de cobertura
â”œâ”€â”€ cobertura.info             â† Arquivo gerado pelo lcov
â”œâ”€â”€ gcov/                      â† RelatÃ³rios .gcov gerados pelo gcov
â”œâ”€â”€ include/                   â† Arquivos header (.h)
â”‚   â”œâ”€â”€ divisao.h
â”‚   â”œâ”€â”€ soma.h
â”‚   â””â”€â”€ subtracao.h
â”œâ”€â”€ obj/                       â† Objetos compilados e arquivos de cobertura (.o, .gcda, .gcno)
â”œâ”€â”€ src/                       â† CÃ³digo-fonte principal
â”‚   â”œâ”€â”€ divisao.c
â”‚   â”œâ”€â”€ soma.c
â”‚   â””â”€â”€ subtracao.c
â”œâ”€â”€ tests/                     â† Testes unitÃ¡rios
â”‚   â”œâ”€â”€ bin/                   â† BinÃ¡rios dos testes
â”‚   â”‚   â”œâ”€â”€ test_divisao
â”‚   â”‚   â”œâ”€â”€ test_soma
â”‚   â”‚   â””â”€â”€ test_subtracao
â”‚   â”œâ”€â”€ test_divisao.c
â”‚   â”œâ”€â”€ test_soma.c
â”‚   â””â”€â”€ test_subtracao.c
```
---
## âš™ï¸ Comandos do Makefile

| Comando             | DescriÃ§Ã£o                                                              |
|---------------------|------------------------------------------------------------------------|
| `make`              | Compila os arquivos da pasta `src/` e gera o binÃ¡rio `main`            |
| `make test`         | Compila os testes e gera binÃ¡rios em `tests/bin/`                      |
| `make run_test_xyz` | Executa o teste `test_xyz` individualmente                             |
| `make coverage`     | Gera arquivos `.gcov` em `gcov/` usando `gcov`                         |
| `make lcov-html`    | Gera relatÃ³rio HTML com `lcov` em `cobertura_html/` e abre no navegador|
| `make gcovr-html`   | Gera relatÃ³rio HTML com `gcovr` e abre no navegador                    |
| `make gcovr-cli`    | Exibe cobertura direto no terminal                                     |
| `make clean`        | Remove arquivos de build, cobertura e testes                           |
| `lcov --capture --directory . --output-file cobertura.info`   | Captura dados de cobertura para gerar um arquivo de informaÃ§Ãµes.         |
| `genhtml cobertura.info --output-directory cobertura_html`    | Gera relatÃ³rios de cobertura em HTML a partir do arquivo de informaÃ§Ãµes. |
| `xdg-open cobertura_html/index.html`                          | Abre automaticamente o relatÃ³rio HTML no navegador (para sistemas Linux).

---
## ğŸ§ª ExecuÃ§Ã£o com Makefile

1. Compile os testes:
   ```bash
   make test
   ```
3. Execute um teste:
   ```bash
   make run_test_soma
   make run_test_divisao
   ```
4. Gere relatÃ³rio com `gcovr` (CLI)
   ```bash
   make gcovr-cli
   ```
5. Gere relatÃ³rio com `gcovr` (HTML):
   ```bash
   make gcovr-html
   ```
6. Gere relatÃ³rio HTML com `lcov`:
   ```bash
   make lcov-html
   ```
7. Limpe todos os arquivos gerados:
   ```bash
   make clean
   ```
---
## ğŸ“œ LicenÃ§a das Ferramentas

**`libcunit1-dev` â€” LGPL (Lesser General Public License)**
- **Uso:** VocÃª pode usar, modificar e distribuir a biblioteca, inclusive em projetos fechados.
- **Regras:** Se modificar a prÃ³pria biblioteca, precisa liberar essas modificaÃ§Ãµes. Mas seu cÃ³digo que usa a biblioteca pode ser fechado.
- **Resumo:** Permissiva para uso em projetos abertos ou fechados, mas alteraÃ§Ãµes na biblioteca devem ser abertas.

---
**`libcmocka-dev` â€” Apache License 2.0**
- **Uso:** ModificaÃ§Ã£o e distribuiÃ§Ã£o livres, inclusive para uso comercial.
- **Regras:** Precisa dar crÃ©dito aos autores, incluir a licenÃ§a e avisar sobre mudanÃ§as. Permite uso em software proprietÃ¡rio.
- **Resumo:** Muito permissiva, inclusive para projetos fechados e comerciais.

---
**`lcov` â€” GPL (General Public License)**
- **Uso:** VocÃª pode usar, modificar e distribuir, mas qualquer software derivado deve ser tambÃ©m GPL (cÃ³digo aberto).
- **Regras:** Se modificar e distribuir, precisa liberar o cÃ³digo-fonte dessas modificaÃ§Ãµes.
- **Resumo:** SÃ³ pode ser usado em projetos fechados se nÃ£o modificar o lcov; se modificar e distribuir, tem que abrir o cÃ³digo.

---
**`gcovr` â€” BSD License**
- **Uso:** ModificaÃ§Ã£o e distribuiÃ§Ã£o livres, inclusive para uso comercial.
- **Regras:** SÃ³ precisa manter o aviso de copyright e a licenÃ§a.
- **Resumo:** Extremamente permissiva, pode usar em qualquer projeto, aberto ou fechado.

---
